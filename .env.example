# =============================================================================
# Community Pulse - Environment Variables Template
# =============================================================================
# Copy this file to .env.local and fill in the values
# Last updated: January 2026
#
# Legend:
#   [REQUIRED] - App will fail without this
#   [IMPORTANT] - Core features need this
#   [OPTIONAL] - Enhanced features, has fallback
# =============================================================================

# -----------------------------------------------------------------------------
# SUPABASE - Database & Authentication [REQUIRED]
# -----------------------------------------------------------------------------
# Get these from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api

# Public (safe to expose in browser)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here

# Secret (server-side only - NEVER expose)
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# -----------------------------------------------------------------------------
# AI MODERATION - Content Safety [REQUIRED]
# -----------------------------------------------------------------------------
# The app uses a fail-closed moderation system. Without these keys,
# ALL pulse creation will fail with 503 errors.

# Primary moderation - OpenAI
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-key-here

# Alternative/backup moderation - Anthropic Claude Haiku
# Get from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here

# -----------------------------------------------------------------------------
# PUSH NOTIFICATIONS - VAPID Keys [IMPORTANT]
# -----------------------------------------------------------------------------
# Generate with: node scripts/generate-vapid-keys.js

# Public key (can be exposed in browser)
NEXT_PUBLIC_VAPID_PUBLIC_KEY=your-vapid-public-key
VAPID_PUBLIC_KEY=your-vapid-public-key

# Private key (server-side only)
VAPID_PRIVATE_KEY=your-vapid-private-key

# Contact email for push service (optional, has default)
VAPID_SUBJECT=mailto:hello@communitypulse.app

# -----------------------------------------------------------------------------
# SCHEDULED JOBS & ADMIN [IMPORTANT]
# -----------------------------------------------------------------------------
# Generate with: openssl rand -hex 32

# Cron job authentication (for Vercel scheduled functions)
CRON_SECRET=your-cron-secret-here

# Admin API authentication
ADMIN_SECRET=your-admin-secret-here
ADMIN_API_KEY=your-admin-api-key-here

# -----------------------------------------------------------------------------
# EXTERNAL APIs - Data Enrichment [IMPORTANT]
# -----------------------------------------------------------------------------

# Ticketmaster - Events
# Get from: https://developer.ticketmaster.com/
TICKETMASTER_API_KEY=your-ticketmaster-key-here

# TomTom - Traffic data
# Get from: https://developer.tomtom.com/
TOMTOM_API_KEY=your-tomtom-key-here

# Foursquare - Local places (has OSM fallback)
# Get from: https://developer.foursquare.com/
FOURSQUARE_API_KEY=your-foursquare-key-here

# -----------------------------------------------------------------------------
# EXTERNAL APIs - Optional Enhancements [OPTIONAL]
# -----------------------------------------------------------------------------

# OpenWeather - Geocoding (has fallback)
# Get from: https://openweathermap.org/api
OPENWEATHER_API_KEY=your-openweather-key-here
NEXT_PUBLIC_GEOCODING_API_KEY=your-geocoding-key-here

# EIA - Gas prices (has hardcoded fallback)
# Get from: https://www.eia.gov/opendata/
EIA_API_KEY=your-eia-key-here

# Google Perspective API - Supplementary toxicity detection
# Get from: https://developers.perspectiveapi.com/
PERSPECTIVE_API_KEY=your-perspective-key-here

# Google Cloud DLP - Enhanced PII detection
GOOGLE_DLP_API_KEY=your-google-dlp-key-here

# -----------------------------------------------------------------------------
# APPLICATION CONFIG [OPTIONAL]
# -----------------------------------------------------------------------------

# Base URL for QR codes and sharing (defaults to localhost in dev)
NEXT_PUBLIC_APP_URL=https://your-app-url.vercel.app

# -----------------------------------------------------------------------------
# MODERATION BEHAVIOR CONFIG [OPTIONAL - Defaults are secure]
# -----------------------------------------------------------------------------
# WARNING: These are for development/testing. Production always fails closed.

# Moderation timeout in milliseconds (default: 3000)
MODERATION_TIMEOUT_MS=3000

# PII detection timeout in milliseconds (default: 1500)
PII_TIMEOUT_MS=1500

# Block social media handles like @username (default: true)
PII_BLOCK_SOCIAL_HANDLES=true

# Allow "my name is X" patterns (default: false)
PII_ALLOW_NAMES=false

# Perspective API thresholds (defaults: 0.7, 0.5)
PERSPECTIVE_TOXICITY_THRESHOLD=0.7
PERSPECTIVE_SEVERE_TOXICITY_THRESHOLD=0.5
PERSPECTIVE_TIMEOUT_MS=2000

# OpenAI harassment score threshold (default: 0.01)
MODERATION_HARASSMENT_SCORE_THRESHOLD=0.01

# =============================================================================
# IMPORTANT NOTES
# =============================================================================
#
# 1. FAIL-CLOSED MODERATION:
#    In production, MODERATION_FAIL_OPEN is ALWAYS ignored.
#    If moderation services fail, pulse creation returns 503.
#    This is a security feature, not a bug.
#
# 2. DATABASE MIGRATIONS:
#    After setting up env vars, run these migrations in Supabase SQL Editor:
#    - 20241228_gamification_system.sql
#    - 20241227_bat_signal_notifications.sql
#    - 20241229_venue_vibes.sql
#
# 3. VAPID KEYS:
#    Generate a new pair for each environment (dev, staging, prod).
#    Never reuse keys across environments.
#
# 4. SECRETS:
#    Never commit .env.local to git.
#    Use Vercel environment variables for production.
#
# =============================================================================
